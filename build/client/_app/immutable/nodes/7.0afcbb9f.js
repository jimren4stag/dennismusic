import{_ as R}from"../chunks/preload-helper.a4192956.js";import{s as V,n as P,o as G}from"../chunks/scheduler.ca1ddca6.js";import{S as j,i as q,g as $,h as k,j as b,f as m,a as p,A as H,m as d,n as h,y as u,o as w,e as y,t as v,b as A,d as g,p as C,s as L,r as E,c as M,u as J,v as O,w as S,q as T}from"../chunks/index.4f779291.js";import{e as D}from"../chunks/each.e59479a4.js";function I(c,e,n){const t=c.slice();return t[2]=e[n],t}function N(c){let e,n=c[2]+"",t,a,r=c[0][c[2]]+"",s;return{c(){e=$("div"),t=d(n),a=d(": "),s=d(r)},l(o){e=k(o,"DIV",{});var i=b(e);t=h(i,n),a=h(i,": "),s=h(i,r),i.forEach(m)},m(o,i){p(o,e,i),u(e,t),u(e,a),u(e,s)},p(o,i){i&2&&n!==(n=o[2]+"")&&w(t,n),i&3&&r!==(r=o[0][o[2]]+"")&&w(s,r)},d(o){o&&m(e)}}}function z(c){let e,n=D(c[1]),t=[];for(let a=0;a<n.length;a+=1)t[a]=N(I(c,n,a));return{c(){e=$("div");for(let a=0;a<t.length;a+=1)t[a].c()},l(a){e=k(a,"DIV",{});var r=b(e);for(let s=0;s<t.length;s+=1)t[s].l(r);r.forEach(m)},m(a,r){p(a,e,r);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null)},p(a,[r]){if(r&3){n=D(a[1]);let s;for(s=0;s<n.length;s+=1){const o=I(a,n,s);t[s]?t[s].p(o,r):(t[s]=N(o),t[s].c(),t[s].m(e,null))}for(;s<t.length;s+=1)t[s].d(1);t.length=n.length}},i:P,o:P,d(a){a&&m(e),H(t,a)}}}function B(c,e,n){let{stats:t={}}=e,a=[];return c.$$set=r=>{"stats"in r&&n(0,t=r.stats)},c.$$.update=()=>{c.$$.dirty&3&&(n(1,a=[]),Object.keys(t).forEach(function(r){a.push(r)}))},[t,a]}class F extends j{constructor(e){super(),q(this,e,B,z,V,{stats:0})}}function K(c){let e,n,t=c[0].params.test_name+"",a,r,s,o,i;return o=new F({props:{stats:c[2]}}),{c(){e=$("div"),n=$("h2"),a=d(t),r=d(" test results"),s=L(),E(o.$$.fragment)},l(l){e=k(l,"DIV",{});var f=b(e);n=k(f,"H2",{});var _=b(n);a=h(_,t),r=h(_," test results"),_.forEach(m),f.forEach(m),s=M(l),J(o.$$.fragment,l)},m(l,f){p(l,e,f),u(e,n),u(n,a),u(n,r),p(l,s,f),O(o,l,f),i=!0},p(l,f){(!i||f&1)&&t!==(t=l[0].params.test_name+"")&&w(a,t);const _={};f&4&&(_.stats=l[2]),o.$set(_)},i(l){i||(g(o.$$.fragment,l),i=!0)},o(l){v(o.$$.fragment,l),i=!1},d(l){l&&(m(e),m(s)),S(o,l)}}}function Q(c){let e,n,t;var a=c[1];function r(s,o){return{}}return a&&(e=T(a,r()),e.$on("complete",c[3])),{c(){e&&E(e.$$.fragment),n=y()},l(s){e&&J(e.$$.fragment,s),n=y()},m(s,o){e&&O(e,s,o),p(s,n,o),t=!0},p(s,o){if(o&2&&a!==(a=s[1])){if(e){C();const i=e;v(i.$$.fragment,1,0,()=>{S(i,1)}),A()}a?(e=T(a,r()),e.$on("complete",s[3]),E(e.$$.fragment),g(e.$$.fragment,1),O(e,n.parentNode,n)):e=null}},i(s){t||(e&&g(e.$$.fragment,s),t=!0)},o(s){e&&v(e.$$.fragment,s),t=!1},d(s){s&&m(n),e&&S(e,s)}}}function U(c){let e,n,t,a,r;const s=[Q,K],o=[];function i(l,f){return f&1&&(e=null),e==null&&(e=!l[0].completed_tests.includes(l[0].params.test_name)),e?0:1}return n=i(c,-1),t=o[n]=s[n](c),{c(){t.c(),a=y()},l(l){t.l(l),a=y()},m(l,f){o[n].m(l,f),p(l,a,f),r=!0},p(l,[f]){let _=n;n=i(l,f),n===_?o[n].p(l,f):(C(),v(o[_],1,1,()=>{o[_]=null}),A(),t=o[n],t?t.p(l,f):(t=o[n]=s[n](l),t.c()),g(t,1),t.m(a.parentNode,a))},i(l){r||(g(t),r=!0)},o(l){v(t),r=!1},d(l){l&&m(a),o[n].d(l)}}}function W(c,e,n){let{data:t}=e,a,r;G(async()=>{n(1,a=(await R(()=>import("../../../lib/sleepapp/tests/"+t.params.test_name+".svelte"),[],import.meta.url)).default),await fetch("/cookies?"+t.params.test_name,{method:"GET"}).then(o=>o.json()).then(o=>n(2,r=o.body)),console.log(r)});const s=o=>{fetch("/cookies",{method:"POST",body:JSON.stringify({name:"completed_tests",value:t.params.test_name})}).then(i=>location.reload()).catch(i=>{console.error(i)}),fetch("/cookies",{method:"POST",body:JSON.stringify({name:t.params.test_name,value:o.detail})}).then(i=>location.reload()).catch(i=>{console.error(i)})};return c.$$set=o=>{"data"in o&&n(0,t=o.data)},[t,a,r,s]}class ee extends j{constructor(e){super(),q(this,e,W,U,V,{data:0})}}export{ee as component};
